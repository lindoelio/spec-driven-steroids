# Agent Guidelines for Spec Driven Steroids

This document provides instructions and context for AI coding agents (and human developers) working on the `spec-driven-steroids` repository. This project is a monorepo that builds tools to inject specification-driven development workflows into other projects.

## 1. Environment & Setup

- **Language:** TypeScript (Node.js)
- **Package Manager:** `pnpm` (required)
- **Monorepo:** Uses pnpm workspaces.
- **Node Version:** >=20.0.0

## 2. Build, Lint, and Test Commands

All commands should typically be run from the repository root.

### Core Commands
- **Install Dependencies:**
  ```bash
  pnpm install
  ```
- **Build All Packages:**
  ```bash
  pnpm build
  ```
  This runs `tsc` in all packages. Ensure this passes before submitting changes.
- **Typecheck:**
  ```bash
  pnpm typecheck
  ```
- **Lint:**
  ```bash
  pnpm lint
  ```
- **Test:**
  ```bash
  pnpm test
  ```
  Runs tests for all packages once without watch mode.
- **Test UI:**
  ```bash
  pnpm test:ui
  ```
  Opens Vitest UI for interactive test debugging.
- **Test Coverage:**
  ```bash
  pnpm test:coverage
  ```
  Runs tests with coverage reporting and generates HTML coverage reports.

### Package-Specific Commands
To run a command for a specific package (e.g., only the MCP server), use the `--filter` flag:

```bash
# Build only the MCP package
pnpm --filter @spec-driven-steroids/mcp build

# Build only the CLI package
pnpm --filter spec-driven-steroids build
```

## 3. Project Structure

- **`packages/mcp`**: The Model Context Protocol server.
  - Implements `verify_spec_structure`, `verify_requirements_file`, `verify_design_file`, `verify_tasks_file`, and `verify_complete_spec` tools.
  - Uses `@modelcontextprotocol/sdk`.
- **`packages/cli`**: The command-line interface (`spec-driven-steroids`).
  - Handles the `inject` command to set up environments.
  - Uses `commander`, `inquirer`, `fs-extra`.
- **`packages/standards`**: Contains Markdown templates and standard definitions for agents and skills.

## 4. Code Style & Conventions

### TypeScript & ESM
- **Strict Mode:** enabled in `tsconfig.base.json`.
- **Module System:** ESM (`"type": "module"`).
- **Import Extensions:** You **MUST** use `.js` extensions for relative imports.
- **Path Aliases:** Avoid complex path aliases; use relative paths or workspace dependencies.

### Naming Conventions
- **Variables/Functions:** `camelCase` (e.g., `verifyEarsSyntax`, `injectConfig`).
- **Classes:** `PascalCase` (e.g., `McpServer`).
- **Files:** `kebab-case` (e.g., `mcp-server.ts`, `cli-utils.ts`).

### Error Handling
- Use `try/catch` blocks for all file system operations and external calls.
- In CLI commands, catch errors at the top level and log them clearly with `console.error` and `chalk.red`.

## 5. Spec-Driven Standards (Self-Hosting)

### Folder & File Convention (Kiro-inspired)
All specifications generated or managed by the toolkit MUST follow this structure:
`specs/changes/<short-ai-generated-slug>/[requirements.md | design.md | tasks.md]`

### Standards
- **EARS:** Requirements must support `WHEN`, `IF`, `THEN`, `SHALL` keywords.
- **Mermaid:** Design docs must include Mermaid diagrams for architecture/flows.
- **Traceability:** Link Requirements (`REQ-X`) to Design (`DES-X`) to Tasks.

### Specialized Agent Skills
The following specialized skills MUST be invoked at each step of the flow:
- **Requirements**: Invoke `spec-driven-requirements-writer`
- **Design**: Invoke `spec-driven-technical-designer`
- **Task Decomposition**: Invoke `spec-driven-task-decomposer`
- **Implementation**: Invoke `spec-driven-task-implementer`

### GitHub Copilot Integration
- Unified Agent: **`spec-driven.agent.md`** handles the full flow from requirements to task decomposition, explicitly invoking the specialized skills above.

## 6. Contribution Workflow

1.  **Create Branch:** `git checkout -b feature/my-feature`
2.  **Implement:** Write code in `src/`.
3.  **Verify:** Run `pnpm build` at the root to ensure types are correct.
4.  **Lint:** Run `pnpm lint`.
5.  **Commit:** Use conventional commits.
6.  **Changeset:** If changes affect published packages, run `pnpm changeset` to document the change.

## 7. Versioning & Release

This project uses [Changesets](https://github.com/changesets/changesets) for version management.

### Release Commands
- `pnpm changeset` - Create a changeset describing the change
- `pnpm changeset:version` - Bump versions & update CHANGELOGs
- `pnpm changeset:publish` - Publish to npm

### Fixed Versioning
All publishable packages share the same version:
- `spec-driven-steroids` (CLI)
- `@spec-driven-steroids/mcp`
- `@spec-driven-steroids/standards`

---
*Generated by OpenCode Agent on Feb 06, 2026*
